#include "TFile.h"
#include "TTree.h"
#include "TH1.h"
#include "TH2.h"
#include "TH3.h"
#include "TF2.h"
#include <TVector3.h>
#include <fstream>
#include <sstream>
#include <math.h>
#include <cstring>
#include <vector>
#include "TMath.h"
#include <stdio.h>
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <stdarg.h>

////////////// VALORI CENTRALI BINS //////////////////
double Beta_cent[30]={0.41,0.43,0.45,0.47,0.49,0.51,0.53,0.55,0.57,0.59,0.61,0.63,0.65,0.67,0.69,0.71,0.73,0.75,0.77,0.79,0.81,0.83,0.85,0.87,0.89,0.91,0.93,0.95,0.97,0.99,};
double PiccoBeta[30]={0,0.01,0.02,0.03,0.440917,0.366032,0.415973,0.455373,0.491159,0.521921,0.551876,0.580046,0.605327,0.632911,0.656168,0.681199,0.704225,0.728863,0.750751,0.769231,0.793651,0.814332,0.83612,0.859106,0.877193,0.902527,0.922509,0.943396,0.957854,0.980392,};
double betacent[30]={0,0,0,0,0.483333,0.503333,0.523333,0.543333,0.563333,0.583333,0.603333,0.623333,0.643333,0.663333,0.683333,0.703333,0.723333,0.743333,0.763333,0.783333,0.803333,0.823333,0.843333,0.863333,0.883333,0.903333,0.923333,0.943333,0.963333,0.983333,};
double valorecent[24]={0.620376,0.79053,1.28364,1.63572,2.08435,2.65604,3.38452,4.31281,5.49571,7.00304,8.9238,11.3714,14.4903,18.4646,23.5289,29.9823,38.2058,48.6846,62.0376,79.053,100.735,128.364,162.378,0,};
///////////////////////////////////////////////////////

////////////////// CORREZIONE R Mis:Gen //////////////////////
double R_gen[34]={0.5633,       0.6490, 0.8449, 1.0408, 1.1755, 1.3347, 1.5306, 1.7510, 1.9469, 2.1551, 2.3510, 2.5347, 2.7551, 2.9878, 3.2204, 3.5143, 3.7347, 3.9429, 4.1755, 4.4204, 4.6653, 4.9469, 5.1918, 5.5224, 5.7918, 6.0122, 7.0000, 8.0000, 9.0000, 10.0000,        11.0000,        20.0000,        50.0000,        100.0000};
double R_mis[34]={0.7306,       1.0000, 1.3367, 1.6902, 1.9764, 2.1279, 2.2626, 2.3805, 2.4310, 2.5320, 2.7172, 2.8182, 3.0034, 3.1886, 3.3232, 3.5926, 3.8114, 4.0303, 4.2660, 4.4680, 4.6532, 4.9226, 5.1414, 5.4613, 5.7643, 6.0337, 7.0000, 8.0000, 9.0000, 10.0000,        11.0000,        20.0000,        50.0000,        100.0000};
//////////////////////////////////////////////////////////////
////////////////// CORREZIONE RICH //////////////////////
double R_rich[25]={3.18055,     3.57491,        4.01817,        4.51638,        5.07637,        5.70579,        6.41325,        7.20844,        8.10221,        9.10681,        10.236,         11.5051,        12.9317,        14.5351,        16.3373,        18.3629,        20.6398,        23.1989,        26.0753,        29.3084,        32.9424,        37.0269,        41.6179,        46.7781,        52.5781};
double Corr_rich[25]={1.00213,  1.00045,        1.00006,        0.99960,        0.99930,        0.99921,        0.99903,        0.99895,        0.99894,        0.99888,        0.99890,        0.99887,        0.99885,        0.99882,        0.99887,        0.99883,        0.99881,        0.99883,        0.99886,        0.99885,        0.99880,        0.99888,        0.99884,        0.99883,        0.99888};
//////////////////////////////////////////////////////////////
////////////// SIGMA INVERSE //////////////////
double sigmaEL1Uinv[30]={0.970957,1.04192,1.10556,1.14401,1.24219,1.26227,1.30781,1.35168,1.45222,1.47188,1.57204,1.73897,1.66397,1.81122,1.87095,2.03394,2.19796,2.21012,2.31127,2.5424,2.57978,2.74788,2.86475,3.11243,3.11764,3.2911,3.31339,3.33095,3.36837,3.43848,};
double sigmaEtofUinv[30]={0.0101297,0.0110989,0.0120282,0.0131133,0.0144645,0.0158628,0.0169694,0.0186552,0.02047,0.0220818,0.0236242,0.0256012,0.0279676,0.0301341,0.0326991,0.0355509,0.038673,0.0417572,0.0447985,0.0482951,0.05181,0.0555078,0.0596518,0.0640575,0.0704583,0.075315,0.0723733,0.0690903,0.0686398,0.0685094,};
double sigmaEtrackinv[30]={0.41056,0.436897,0.462218,0.488687,0.51566,0.543865,0.573436,0.595749,0.629892,0.667451,0.697552,0.730861,0.764488,0.795942,0.826946,0.859546,0.896498,0.935313,0.9639,1.01319,1.04522,1.07816,1.13431,1.16763,1.19834,1.2238,1.24327,1.2485,1.26364,1.25528,};
double sigmaETofDinv[30]={0.00853534,0.00903033,0.0101331,0.0115938,0.012811,0.0138879,0.0158775,0.0173705,0.0191504,0.0216741,0.0237663,0.0258621,0.0285843,0.031213,0.0335755,0.0369004,0.0395596,0.0435354,0.0464305,0.0504471,0.0527212,0.0580913,0.0618128,0.0653969,0.0748281,0.0804738,0.081752,0.0764883,0.0761559,0.0762702,};
double sigmabetainv[30]={0,0,0,0,0,0.0929367,0.0565443,0.0437849,0.0379531,0.0341387,0.031662,0.029738,0.0288943,0.0279256,0.0275206,0.0276242,0.0277547,0.0282102,0.0286772,0.0292948,0.0299222,0.0308157,0.0313665,0.0322035,0.0331144,0.0338065,0.0344434,0.0353787,0.0359952,0.0362678,};
double sigmaRinv[24]={0.348232,0.199008,0.127109,0.0903188,0.065722,0.0492337,0.0375834,0.029166,0.0230523,0.0181399,0.0145463,0.0119335,0.00979743,0.00829124,0.00724542,0.00635019,0.00567553,0.00530079,0.00503532,0.00483557,0.00472022,0.00448518,0.00443712,0,};
///////////////////////////////////////////////////////

////////////// CURVE TEORICHE //////////////////
double EL1[30]={0.245547,0.237816,0.227947,0.219182,0.21111,0.202293,0.193406,0.186228,0.178492,0.170928,0.162972,0.156751,0.149985,0.14368,0.136937,0.130776,0.126023,0.120878,0.115004,0.11083,0.106096,0.101696,0.0966076,0.0935387,0.0900668,0.0871954,0.0861131,0.0857362,0.0856461,0.0857493,};
double ETOFU[30]={6.79949,6.45587,6.11214,5.79775,5.49986,5.20407,4.94075,4.6989,4.46422,4.24133,4.04447,3.84596,3.67633,3.51737,3.37001,3.21704,3.08622,2.98246,2.86636,2.75453,2.64742,2.54568,2.46139,2.35995,2.25499,2.15223,2.10089,2.07612,2.03444,2.02878,};
double ETrack[30]={0.455469,0.423853,0.395121,0.369948,0.347769,0.327987,0.3103,0.294531,0.280963,0.269078,0.257223,0.245605,0.23467,0.2258,0.216827,0.209071,0.202184,0.195579,0.189428,0.183676,0.179251,0.173987,0.168831,0.163942,0.160387,0.156104,0.154149,0.153156,0.152782,0.152665,};
double ETOFD[30]={9.42785,8.40718,7.59028,6.93065,6.38188,5.91976,5.50794,5.14134,4.81215,4.52703,4.27131,4.05617,3.84279,3.66294,3.4782,3.32355,3.1771,3.04323,2.91502,2.79547,2.68128,2.59665,2.49237,2.38775,2.28355,2.21541,2.13379,2.10078,2.07869,2.02932,};
TF1 *protons = new TF1("f1","pow((pow(x,2)/pow(0.938,2)/(1 + pow(x,2)/pow(0.938,2))),0.5)",0.1,100);
TF1 *deutons = new TF1("f1","pow((pow(x,2)/pow(1.875,2)/(1 + pow(x,2)/pow(1.875,2))),0.5)",0.1,100);
///////////////////////////////////////////////////////

////////////// CORREZIONE E.DEP. MC //////////////////
double CorrL1[30]={1.02892,1.01699,1.01093,0.996998,0.987631,0.98223,0.981408,0.973845,0.963916,0.964413,0.953421,0.941946,0.946586,0.943767,0.939689,0.932729,0.927501,0.928593,0.921861,0.919048,0.917647,0.915444,0.91103,0.90271,0.907434,0.904559,0.905789,0.904259,0.899235,0.894925,};
double CorrTOFU[30]={0.922785,0.926525,0.926267,0.923405,0.927849,0.933895,0.936024,0.937066,0.943805,0.948782,0.951015,0.953197,0.958283,0.96269,0.966654,0.971046,0.975685,0.982298,0.986328,0.990023,0.995433,0.999085,1.00287,1.00433,1.00776,1.01442,1.02362,1.0196,1.01032,1.0038,};
double CorrTrack[30]={1.23725,1.20373,1.1743,1.14731,1.12393,1.10595,1.09121,1.07941,1.07135,1.06692,1.06271,1.0596,1.0552,1.05268,1.05074,1.04798,1.04676,1.04588,1.04355,1.04306,1.04151,1.03901,1.03568,1.0321,1.02739,1.02324,1.01907,1.01142,1.00324,0.997816,};
double CorrTOFD[30]={0.998634,1.04202,0.907907,0.913276,0.923665,0.925975,0.930067,0.93805,0.942484,0.950782,0.961306,0.966506,0.971267,0.976089,0.980662,0.984296,0.987571,0.992293,0.995607,0.999293,1.00323,1.00597,1.00955,1.0109,1.01424,1.02532,1.03962,1.0366,1.02351,1.0086,};
///////////////////////////////////////////////////////

////////////// DEFINIZIONE SPLINES //////////////////
TSpline3 *Rig = new TSpline3("Cubic Spline",valorecent,sigmaRinv,23);
TSpline3 *beta = new TSpline3("beta",PiccoBeta,sigmabetainv,30);
TSpline3 *eL1 = new TSpline3("Cubic Spline",Beta_cent,sigmaEL1Uinv,30);
TSpline3 *etofu = new TSpline3("Cubic Spline",Beta_cent,sigmaEtofUinv,30);
TSpline3 *etrack = new TSpline3("Cubic Spline",Beta_cent,sigmaEtrackinv,30);
TSpline3 *etofd = new TSpline3("Cubic Spline",Beta_cent,sigmaETofDinv,30);
TSpline3 *EdepL1beta = new TSpline3("Cubic Spline",Beta_cent,EL1,30);
TSpline3 *EdepTOFbeta = new TSpline3("Cubic Spline",Beta_cent,ETOFU,30);
TSpline3 *EdepTrackbeta = new TSpline3("Cubic Spline",Beta_cent,ETrack,30);
TSpline3 *EdepTOFDbeta = new TSpline3("Cubic Spline",Beta_cent,ETOFD,30);
TSpline3 *Corr_L1 = new TSpline3("Cubic Spline",Beta_cent,CorrL1,30);
TSpline3 *Corr_TOFU = new TSpline3("Cubic Spline",Beta_cent,CorrTOFU,30);
TSpline3 *Corr_Track = new TSpline3("Cubic Spline",Beta_cent,CorrTrack,30);
TSpline3 *Corr_TOFD = new TSpline3("Cubic Spline",Beta_cent,CorrTOFD,30);
TSpline3 *Rgenmis = new TSpline3("",R_mis,R_gen,34);
TSpline3 *CorrRICH = new TSpline3("",R_rich,Corr_rich,25);
///////////////////////////////////////////////////////

void Functions_auto(){}
